# אפיון מערכת מיפוי קשרים - Knowledge Graph System

## 1. מטרת המערכת

מערכת מיפוי קשרים (Knowledge Graph) לזיהוי, תיעוד וניתוח של קשרים בין:
- **ארגונים** (קרנות, עמותות, מוסדות אקדמיים, גופים ממשלתיים)
- **אנשים** (חוקרים, מנהיגים, פעילים, בעלי תפקידים)
- **תוכניות ופרויקטים** (תוכניות חינוכיות, מחקרים, יוזמות)
- **מושגים ורעיונות** (מונחים אידאולוגיים, פרדיגמות, מסגורים)
- **אירועים** (מקרים, תגובות, דיווחים)
- **מסמכים וכתבות** (מקורות מידע, דוחות, פרסומים)

**המטרה:** ליצור מפה ויזואלית של הקשרים בין כל הגורמים הללו, תוך התמקדות בזיהוי:
- קשרים עקיפים (לא ישירים)
- השפעות אידאולוגיות
- זרימת רעיונות ומושגים
- דפוסים חוזרים
- נקודות השפעה מרכזיות

---

## 2. עקרונות יסוד

### 2.1 Evidence-First (ראיות קודמות)
**כל קשר חייב להיות מגובה בראיות:**
- קישור למקור (URL, PDF, מסמך)
- ציטוט רלוונטי
- מיקום במסמך (עמוד, שורות)
- תמונה/צילום מסך

**למה זה קריטי:**
- אמינות - לא "רכילות" אלא מידע מבוסס
- הגנה משפטית - כל טענה מגובה
- יכולת בדיקה - אפשר לחזור למקור

### 2.2 Versioning (גרסאות)
**כל שינוי נשמר:**
- מי עשה את השינוי
- מתי
- מה היה לפני השינוי
- אפשרות לחזור לגרסה קודמת

**למה זה חשוב:**
- מעקב אחר התפתחות המידע
- אפשרות לתקן טעויות
- שקיפות מלאה

### 2.3 Audit Trail (יומן פעולות)
**כל פעולה נרשמת:**
- מי ביצע
- מה בוצע
- מתי
- מאיפה (IP, User Agent)

**למה זה נדרש:**
- אבטחה
- אחריות
- ניפוי שגיאות

### 2.4 Flags & Tags (תיוגים)
**צמתים יכולים להיות מתויגים:**
- `problematic` - בעייתי/מחשיד
- `suspicious` - מחשיד
- `key_player` - שחקן מפתח
- `academic` - אקדמי
- `ideology` - אידאולוגי

**למה:**
- זיהוי מהיר של גורמים מרכזיים
- פילטרים ויזואליים
- התראות אוטומטיות

---

## 3. סוגי עבודה - שלושה מסלולים

### 3.1 מסלול 1: הכנסת מידע ידנית

**תיאור:**
עבודה אנושית מדויקת, מבוקרת, עם בדיקה של כל פרט.

**תהליך העבודה:**

1. **איסוף מידע ראשוני:**
   - קריאת מסמכים
   - ניתוח כתבות
   - מעקב אחר פרסומים
   - ניתוח אתרים ופרסומים

2. **יצירת צמתים (Nodes):**
   - הוספת ארגון חדש
   - הוספת אדם חדש
   - הוספת מושג/רעיון חדש
   - הוספת אירוע/מקרה

3. **יצירת קשרים (Edges):**
   - זיהוי קשר בין שני צמתים
   - בחירת סוג קשר (PROMOTES, FUNDED_BY, וכו')
   - הוספת ראיות (קישור, ציטוט, מסמך)
   - קביעת רמת ביטחון (high/medium/low)

4. **בדיקה ואימות:**
   - בדיקת כל ראיה
   - וידוא שהקשר נכון
   - עדכון/תיקון לפי צורך

**יתרונות:**
- דיוק גבוה
- שליטה מלאה
- איכות גבוהה

**חסרונות:**
- איטי
- דורש זמן רב
- לא מתאים לכמויות גדולות

**מתי להשתמש:**
- מידע קריטי/רגיש
- מקרים מורכבים
- כאשר צריך דיוק מקסימלי

---

### 3.2 מסלול 2: ייבוא מתיקייה מקומית

**תיאור:**
המערכת סורקת תיקייה במחשב, מזהה קבצים (PDF, DOCX, TXT, HTML), מחלצת מידע ומכניסה אוטומטית.

**תהליך העבודה:**

1. **הכנת התיקייה:**
   ```
   /import_data/
     ├── organizations/
     │   ├── handasiv_report.pdf
     │   ├── shapi_info.docx
     │   └── ...
     ├── people/
     │   ├── researcher_x.txt
     │   └── ...
     ├── concepts/
     │   ├── resilience_analysis.pdf
     │   └── ...
     └── events/
         ├── teacher_case_2023.pdf
         └── ...
   ```

2. **תהליך הייבוא:**
   - סריקת התיקייה
   - זיהוי סוג קובץ
   - חילוץ טקסט (OCR אם צריך)
   - ניתוח תוכן (NLP בסיסי)
   - זיהוי ישויות (שמות ארגונים, אנשים, מושגים)
   - יצירת צמתים אוטומטית
   - יצירת קשרים ראשוניים

3. **בדיקה ידנית:**
   - סקירת הצמתים שנוצרו
   - תיקון/מחיקה של כפילויות
   - הוספת ראיות חסרות
   - עדכון קשרים

**פורמטים נתמכים:**
- PDF (עם חילוץ טקסט)
- DOCX (Word)
- TXT (טקסט פשוט)
- HTML (דפי אינטרנט שמורים)
- CSV (טבלאות מובנות)

**תכונות נדרשות:**
- זיהוי שמות ארגונים (regex patterns)
- זיהוי שמות אנשים
- זיהוי מושגים מרכזיים
- חילוץ קישורים
- חילוץ תאריכים
- זיהוי קשרים (מילות קישור: "מימן", "קידם", "תמך", וכו')

**יתרונות:**
- מהיר יחסית
- מנוצל מידע קיים
- לא דורש עבודה ידנית מלאה

**חסרונות:**
- דורש בדיקה ידנית
- עלול ליצור כפילויות
- דיוק לא מושלם

**מתי להשתמש:**
- יש ארכיון מידע מוכן
- צריך לעבד כמות גדולה
- המידע כבר מאורגן

---

### 3.3 מסלול 3: API אוטונומי - סריקה אוטומטית

**תיאור:**
המערכת סורקת מקורות מידע חיצוניים אוטומטית, מזהה מידע רלוונטי ומכניסה אותו למערכת.

**מקורות מידע אפשריים:**

1. **אתרי חדשות:**
   - RSS feeds
   - API של אתרי חדשות
   - Web scraping (אתרים ספציפיים)

2. **מאגרי מידע אקדמיים:**
   - Google Scholar API
   - ResearchGate
   - מאגרי פרסומים אקדמיים

3. **רשתות חברתיות:**
   - Twitter/X API (פרסומים רלוונטיים)
   - LinkedIn (מידע מקצועי)
   - Facebook (עמודים ציבוריים)

4. **מאגרים ממשלתיים:**
   - אתרי משרדי ממשלה
   - מאגרי תקציבים
   - רשומות ציבוריות

5. **אתרי ארגונים:**
   - אתרי קרנות
   - אתרי עמותות
   - בלוגים ופרסומים

**תהליך העבודה:**

1. **הגדרת מקורות:**
   - רשימת URLs לסריקה
   - תדירות סריקה (יומי, שבועי)
   - מילות מפתח רלוונטיות
   - פילטרים (תאריכים, סוגי תוכן)

2. **סריקה אוטומטית:**
   - גישה למקור
   - חילוץ תוכן
   - ניתוח NLP
   - זיהוי ישויות
   - זיהוי קשרים

3. **יצירת הצעות:**
   - צמתים חדשים (לבדיקה)
   - קשרים חדשים (לבדיקה)
   - ראיות (אוטומטיות)

4. **אישור ידני:**
   - סקירת הצעות
   - אישור/דחייה
   - תיקון פרטים

**תכונות נדרשות:**
- Web scraping (BeautifulSoup, Scrapy)
- NLP לזיהוי ישויות (spaCy, NLTK)
- זיהוי שפה (עברית/אנגלית)
- ניהול תדירות (Cron jobs)
- ניהול duplicates
- התראות על מידע חדש

**יתרונות:**
- אוטומטי לחלוטין
- מעודכן תמיד
- לא דורש עבודה ידנית

**חסרונות:**
- דורש בדיקה ידנית
- עלול ליצור "רעש"
- תלוי באיכות המקורות

**מתי להשתמש:**
- מעקב שוטף
- מקורות רבים
- עדכונים תכופים

---

### 3.4 מסלול 4: DEEP SEARCH עם GPT/AI

**תיאור:**
שימוש ב-GPT (או מודלים דומים) לביצוע חיפושים עמוקים, ניתוח מידע מורכב, והכנסה אוטומטית למערכת.

**תהליך העבודה:**

1. **הגדרת שאילתות:**
   ```
   שאילתות לדוגמה:
   - "מה הקשר בין יד הנדיב לשפ״י?"
   - "מי מקדם את המושג 'חוסן' במערכת החינוך?"
   - "אילו מחקרים קידמו את רעיון ה-SEL בישראל?"
   ```

2. **חיפוש עמוק:**
   - GPT סורק מקורות רבים
   - מנתח מסמכים
   - מזהה קשרים עקיפים
   - בונה מפה של קשרים

3. **יצירת דוח:**
   - רשימת צמתים מוצעים
   - רשימת קשרים מוצעים
   - ראיות לכל קשר
   - רמת ביטחון

4. **אישור והכנסה:**
   - סקירת הדוח
   - אישור/דחייה/תיקון
   - הכנסה למערכת

**תכונות נדרשות:**

1. **ממשק GPT:**
   - OpenAI API
   - Claude API
   - מודלים מקומיים (אם צריך)

2. **Prompt Engineering:**
   ```
   אתה עוזר למיפוי קשרים. מצא:
   1. כל הארגונים הקשורים ל-[X]
   2. כל הקשרים ביניהם
   3. ראיות לכל קשר (קישורים, ציטוטים)
   4. רמת ביטחון (high/medium/low)
   
   החזר ב-JSON:
   {
     "nodes": [...],
     "edges": [...],
     "evidence": [...]
   }
   ```

3. **ניתוח מסמכים:**
   - העלאת PDF/DOCX ל-GPT
   - ניתוח תוכן
   - חילוץ מידע מובנה

4. **חיפוש מקורות:**
   - שילוב עם Google Search API
   - שילוב עם מאגרי מידע
   - אימות מידע

**יתרונות:**
- חיפוש עמוק ומקיף
- זיהוי קשרים עקיפים
- ניתוח מורכב
- חיסכון בזמן

**חסרונות:**
- תלוי באיכות ה-AI
- דורש בדיקה ידנית
- עלויות (אם משתמשים ב-API בתשלום)

**מתי להשתמש:**
- שאלות מורכבות
- חיפוש קשרים עקיפים
- ניתוח מסמכים ארוכים
- מחקר מעמיק

---

## 4. תהליך עבודה מומלץ - שלבים

### שלב 1: בניית תשתית (ידני)
- יצירת צמתים בסיסיים (ארגונים מרכזיים, אנשים מרכזיים)
- יצירת קשרים ידועים וברורים
- בניית "שלד" של המערכת

### שלב 2: הרחבת מידע (ייבוא + ידני)
- ייבוא מידע מתיקייה
- בדיקה ותיקון
- הוספת פרטים חסרים

### שלב 3: מעקב שוטף (API אוטונומי)
- הגדרת מקורות לסריקה
- סריקה אוטומטית יומית/שבועית
- בדיקה ואישור מידע חדש

### שלב 4: מחקר מעמיק (GPT/AI)
- שאילתות מורכבות
- ניתוח מסמכים
- זיהוי קשרים עקיפים

---

## 5. מבנה הנתונים - דוגמאות

### 5.1 דוגמה: מושג בעייתי

**צומת:**
```json
{
  "type": "term",
  "label": "חוסן",
  "description": "מושג שמקודם במערכת החינוך",
  "flags": ["problematic", "ideology"],
  "canonical_key": "term_resilience_he"
}
```

**קשרים:**
- `יד הנדיב --[PROMOTES]--> חוסן`
- `שפ״י --[USES_TERM]--> חוסן`
- `מעוז --[PROMOTES]--> חוסן`

**ראיות:**
- קישור למסמך של יד הנדיב
- ציטוט מתוך מסמך שפ״י
- כתבה על תוכנית מעוז

### 5.2 דוגמה: אירוע בעייתי

**צמתים:**
- `person`: "מורה X"
- `concept`: "רעיון בעייתי Y" (flag: problematic)
- `event`: "מורה X קידם בכיתה"
- `article`: "כותרת הכתבה"
- `org`: "עיריית X"

**קשרים:**
- `מורה X --[PROMOTED]--> רעיון בעייתי Y`
- `מורה X --[INVOLVED_IN]--> אירוע`
- `רעיון בעייתי Y --[RELATED_TO]--> אירוע`
- `כתבה --[REPORTS_ON]--> אירוע`
- `עיריית X --[RESPONDED_TO]--> אירוע`

---

## 6. כלים וטכנולוגיות נדרשות

### 6.1 קיימים (כבר בנויים):
- PHP + MySQL
- Cytoscape.js (ויזואליזציה)
- מערכת אימות
- CRUD APIs

### 6.2 נדרש להוסיף:

**לייבוא מתיקייה:**
- PHP libraries:
  - `smalot/pdfparser` - קריאת PDF
  - `PhpOffice/PhpWord` - קריאת DOCX
  - `spatie/pdf` - עיבוד PDF
- NLP בסיסי:
  - `php-nlp-tools` - זיהוי ישויות
  - Regex patterns - זיהוי שמות

**ל-API אוטונומי:**
- `guzzlehttp/guzzle` - HTTP requests
- `symfony/dom-crawler` - Web scraping
- `cron` jobs - סריקה תקופתית
- Queue system (Redis/RabbitMQ) - ניהול משימות

**ל-GPT/AI:**
- `openai-php/client` - OpenAI API
- `anthropic-php/sdk` - Claude API
- Prompt templates
- JSON parsing ו-validation

---

## 7. ממשק משתמש - תכונות עתידיות

### 7.1 דף ייבוא:
- בחירת תיקייה
- הגדרת כללי זיהוי
- תצוגת התקדמות
- רשימת הצעות לאישור

### 7.2 דף API:
- רשימת מקורות
- הגדרת תדירות
- לוג של סריקות
- התראות על מידע חדש

### 7.3 דף GPT Search:
- הזנת שאילתה
- בחירת מקורות
- תצוגת תוצאות
- אישור/דחייה

### 7.4 דוחות:
- מפת קשרים PDF
- דוח על צומת ספציפי
- ציר זמן של אירועים
- סטטיסטיקות

---

## 8. אבטחה ופרטיות

- כל המידע הוא ציבורי (ארגונים, אנשים ציבוריים)
- אין מידע פרטי
- ראיות - רק מקורות ציבוריים
- Audit log - מעקב אחר כל פעולה

---

## 9. מטרות ארוכות טווח

1. **מפה מלאה** של כל הקשרים הרלוונטיים
2. **זיהוי דפוסים** - אילו ארגונים/אנשים מופיעים יחד
3. **ניתוח השפעה** - מי משפיע על מי
4. **התראות** - על קשרים חדשים/מחשידים
5. **דוחות** - לייצוא ולשיתוף

---

## 10. סיכום

המערכת תומכת ב-4 מסלולי עבודה:
1. **ידני** - דיוק מקסימלי, עבודה מבוקרת
2. **ייבוא** - ניצול מידע קיים, עיבוד מהיר
3. **API** - מעקב שוטף, עדכונים אוטומטיים
4. **GPT/AI** - מחקר מעמיק, זיהוי קשרים מורכבים

כל מסלול משלים את האחרים, והשילוב ביניהם יוצר מערכת חזקה ומקיפה למיפוי קשרים.

